{"version":3,"sources":["webpack://Tv4/webpack/universalModuleDefinition","webpack://Tv4/webpack/bootstrap","webpack://Tv4/./dist/tv4/1.3.0/node_modules/tv4/tv4.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","hasDontEnumBug","dontEnums","dontEnumsLength","keys","toString","propertyIsEnumerable","length","obj","TypeError","result","prop","push","F","arguments","Error","Array","isArray","vArg","indexOf","searchElement","len","Number","Infinity","Math","floor","abs","k","max","isFrozen","random","e","uriTemplateGlobalModifiers","uriTemplateSuffices","notReallyPercentEncode","string","encodeURI","replace","doubleEncoded","substring","uriTemplateSubstitution","spec","modifier","charAt","separator","prefix","shouldEscape","showVariables","trimEmptyString","varNames","varList","split","varSpecs","varSpecMap","varName","truncate","parts","parseInt","suffices","varSpec","subFunction","valueFunction","startIndex","j","encodeURIComponent","first","substitution","UriTemplate","template","textParts","shift","prefixes","substitutions","part","remainder","funcs","concat","fill","fillFromObject","ValidatorContext","parent","collectMultiple","errorReporter","checkRecursive","trackUnknownProperties","missing","missingMap","formatValidators","schemas","errors","handleError","collectError","returnError","scanned","scannedFrozen","scannedFrozenSchemas","scannedFrozenValidationErrors","validatedSchemasKey","validationErrorsKey","knownPropertyPaths","unknownPropertyPaths","defaultErrorReporter","definedKeywords","slice","recursiveCompare","A","B","undefined","defineKeyword","keyword","keywordFunction","createError","code","messageParams","dataPath","schemaPath","subErrors","data","schema","error","ValidationError","message","prefixErrors","prefixWith","banUnknownProperties","unknownPath","ErrorCodes","UNKNOWN_PROPERTY","path","addFormat","format","validator","resolveRefs","urlHistory","CIRCULAR_REFERENCE","urls","join","getSchema","url","baseUrl","fragment","pointerPath","decodeURIComponent","component","searchSchemas","id","testUrl","isTrustedUrl","uri","getDocumentUri","addSchema","normSchema","getSchemaMap","map","getSchemaUris","filterRegExp","list","test","getMissingUris","dropSchemas","reset","validateAll","dataPathParts","schemaPathParts","dataPointerPath","topLevel","frozenIndex","startErrorCount","scannedFrozenSchemaIndex","scannedSchemasIndex","schemaIndex","frozenSchemaIndex","configurable","errorCount","validateBasic","validateNumeric","validateString","validateArray","validateObject","validateCombinations","validateHypermedia","validateFormat","validateDefinedKeywords","pop","dataPart","schemaPart","errorMessage","FORMAT_CUSTOM","validationFunctions","func","KEYWORD_CUSTOM","validateType","validateEnum","type","dataType","allowedTypes","INVALID_TYPE","expected","ENUM_MISMATCH","JSON","stringify","validateMultipleOf","validateMinMax","validateNaN","CLOSE_ENOUGH_LOW","pow","CLOSE_ENOUGH_HIGH","parseURI","String","match","href","protocol","authority","host","hostname","port","pathname","search","hash","resolveUrl","base","input","lastIndexOf","output","baseUri","language","errorMessages","languages","messageTemplate","ErrorMessagesDefault","params","whole","subValue","multipleOf","divisibleBy","NUMBER_MULTIPLE_OF","minimum","NUMBER_MINIMUM","exclusiveMinimum","NUMBER_MINIMUM_EXCLUSIVE","maximum","NUMBER_MAXIMUM","exclusiveMaximum","NUMBER_MAXIMUM_EXCLUSIVE","isNaN","NUMBER_NOT_A_NUMBER","validateStringLength","validateStringPattern","minLength","STRING_LENGTH_SHORT","maxLength","STRING_LENGTH_LONG","pattern","RegExp","regexp","body","flags","literal","STRING_PATTERN","validateArrayLength","validateArrayUniqueItems","validateArrayItems","minItems","ARRAY_LENGTH_SHORT","maxItems","ARRAY_LENGTH_LONG","uniqueItems","ARRAY_UNIQUE","match1","match2","items","additionalItems","ARRAY_ADDITIONAL_ITEMS","validateObjectMinMaxProperties","validateObjectRequiredProperties","validateObjectProperties","validateObjectDependencies","minProperties","OBJECT_PROPERTIES_MINIMUM","propertyCount","maxProperties","OBJECT_PROPERTIES_MAXIMUM","required","OBJECT_REQUIRED","keyPointerPath","foundMatch","properties","patternProperties","patternKey","additionalProperties","OBJECT_ADDITIONAL_PROPERTIES","dependencies","depKey","dep","OBJECT_DEPENDENCY_KEY","requiredKey","validateAllOf","validateAnyOf","validateOneOf","validateNot","allOf","subSchema","anyOf","oldUnknownPropertyPaths","oldKnownPropertyPaths","errorAtEnd","knownKey","unknownKey","ANY_OF_MISSING","oneOf","validIndex","ONE_OF_MULTIPLE","index1","index2","ONE_OF_MISSING","not","oldErrorCount","notErrors","NOT_PASSED","links","ldo","rel","allPresent","ErrorCodeLookup","err","stack","stacktrace","constructor","dataPrefix","schemaPrefix","tv4","createApi","currentLanguage","customErrorReporter","globalContext","api","setErrorReporter","reporter","apply","addLanguage","messageMap","rootCode","freshApi","validate","def","context","valid","validateResult","validateMultiple","defineError","codeName","codeNumber","defaultMessage","langCode","errorCodes"],"mappings":"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","file":"Tv4.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Tv4\"] = factory();\n\telse\n\t\troot[\"Tv4\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/*\r\nAuthor: Geraint Luff and others\r\nYear: 2013\r\n\r\nThis code is released into the \"public domain\" by its author(s).  Anybody may use, alter and distribute the code without restriction.  The author makes no guarantees, and takes no liability of any kind for use of this code.\r\n\r\nIf you find a bug or make an improvement, it would be courteous to let the author know, but it is not compulsory.\r\n*/\r\n(function (global, factory) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    // AMD. Register as an anonymous module.\r\n    define([], factory);\r\n  } else if (typeof module !== 'undefined' && module.exports){\r\n    // CommonJS. Define export.\r\n    module.exports = factory();\r\n  } else {\r\n    // Browser globals\r\n    global.tv4 = factory();\r\n  }\r\n}(this, function () {\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FObject%2Fkeys\r\nif (!Object.keys) {\r\n\tObject.keys = (function () {\r\n\t\tvar hasOwnProperty = Object.prototype.hasOwnProperty,\r\n\t\t\thasDontEnumBug = !({toString: null}).propertyIsEnumerable('toString'),\r\n\t\t\tdontEnums = [\r\n\t\t\t\t'toString',\r\n\t\t\t\t'toLocaleString',\r\n\t\t\t\t'valueOf',\r\n\t\t\t\t'hasOwnProperty',\r\n\t\t\t\t'isPrototypeOf',\r\n\t\t\t\t'propertyIsEnumerable',\r\n\t\t\t\t'constructor'\r\n\t\t\t],\r\n\t\t\tdontEnumsLength = dontEnums.length;\r\n\r\n\t\treturn function (obj) {\r\n\t\t\tif (typeof obj !== 'object' && typeof obj !== 'function' || obj === null) {\r\n\t\t\t\tthrow new TypeError('Object.keys called on non-object');\r\n\t\t\t}\r\n\r\n\t\t\tvar result = [];\r\n\r\n\t\t\tfor (var prop in obj) {\r\n\t\t\t\tif (hasOwnProperty.call(obj, prop)) {\r\n\t\t\t\t\tresult.push(prop);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (hasDontEnumBug) {\r\n\t\t\t\tfor (var i=0; i < dontEnumsLength; i++) {\r\n\t\t\t\t\tif (hasOwnProperty.call(obj, dontEnums[i])) {\r\n\t\t\t\t\t\tresult.push(dontEnums[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t};\r\n\t})();\r\n}\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create\r\nif (!Object.create) {\r\n\tObject.create = (function(){\r\n\t\tfunction F(){}\r\n\r\n\t\treturn function(o){\r\n\t\t\tif (arguments.length !== 1) {\r\n\t\t\t\tthrow new Error('Object.create implementation only accepts one parameter.');\r\n\t\t\t}\r\n\t\t\tF.prototype = o;\r\n\t\t\treturn new F();\r\n\t\t};\r\n\t})();\r\n}\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FisArray\r\nif(!Array.isArray) {\r\n\tArray.isArray = function (vArg) {\r\n\t\treturn Object.prototype.toString.call(vArg) === \"[object Array]\";\r\n\t};\r\n}\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FindexOf\r\nif (!Array.prototype.indexOf) {\r\n\tArray.prototype.indexOf = function (searchElement /*, fromIndex */ ) {\r\n\t\tif (this === null) {\r\n\t\t\tthrow new TypeError();\r\n\t\t}\r\n\t\tvar t = Object(this);\r\n\t\tvar len = t.length >>> 0;\r\n\r\n\t\tif (len === 0) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar n = 0;\r\n\t\tif (arguments.length > 1) {\r\n\t\t\tn = Number(arguments[1]);\r\n\t\t\tif (n !== n) { // shortcut for verifying if it's NaN\r\n\t\t\t\tn = 0;\r\n\t\t\t} else if (n !== 0 && n !== Infinity && n !== -Infinity) {\r\n\t\t\t\tn = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (n >= len) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\r\n\t\tfor (; k < len; k++) {\r\n\t\t\tif (k in t && t[k] === searchElement) {\r\n\t\t\t\treturn k;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n}\r\n\r\n// Grungey Object.isFrozen hack\r\nif (!Object.isFrozen) {\r\n\tObject.isFrozen = function (obj) {\r\n\t\tvar key = \"tv4_test_frozen_key\";\r\n\t\twhile (obj.hasOwnProperty(key)) {\r\n\t\t\tkey += Math.random();\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tobj[key] = true;\r\n\t\t\tdelete obj[key];\r\n\t\t\treturn false;\r\n\t\t} catch (e) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n}\r\n// Based on: https://github.com/geraintluff/uri-templates, but with all the de-substitution stuff removed\r\n\r\nvar uriTemplateGlobalModifiers = {\r\n\t\"+\": true,\r\n\t\"#\": true,\r\n\t\".\": true,\r\n\t\"/\": true,\r\n\t\";\": true,\r\n\t\"?\": true,\r\n\t\"&\": true\r\n};\r\nvar uriTemplateSuffices = {\r\n\t\"*\": true\r\n};\r\n\r\nfunction notReallyPercentEncode(string) {\r\n\treturn encodeURI(string).replace(/%25[0-9][0-9]/g, function (doubleEncoded) {\r\n\t\treturn \"%\" + doubleEncoded.substring(3);\r\n\t});\r\n}\r\n\r\nfunction uriTemplateSubstitution(spec) {\r\n\tvar modifier = \"\";\r\n\tif (uriTemplateGlobalModifiers[spec.charAt(0)]) {\r\n\t\tmodifier = spec.charAt(0);\r\n\t\tspec = spec.substring(1);\r\n\t}\r\n\tvar separator = \"\";\r\n\tvar prefix = \"\";\r\n\tvar shouldEscape = true;\r\n\tvar showVariables = false;\r\n\tvar trimEmptyString = false;\r\n\tif (modifier === '+') {\r\n\t\tshouldEscape = false;\r\n\t} else if (modifier === \".\") {\r\n\t\tprefix = \".\";\r\n\t\tseparator = \".\";\r\n\t} else if (modifier === \"/\") {\r\n\t\tprefix = \"/\";\r\n\t\tseparator = \"/\";\r\n\t} else if (modifier === '#') {\r\n\t\tprefix = \"#\";\r\n\t\tshouldEscape = false;\r\n\t} else if (modifier === ';') {\r\n\t\tprefix = \";\";\r\n\t\tseparator = \";\";\r\n\t\tshowVariables = true;\r\n\t\ttrimEmptyString = true;\r\n\t} else if (modifier === '?') {\r\n\t\tprefix = \"?\";\r\n\t\tseparator = \"&\";\r\n\t\tshowVariables = true;\r\n\t} else if (modifier === '&') {\r\n\t\tprefix = \"&\";\r\n\t\tseparator = \"&\";\r\n\t\tshowVariables = true;\r\n\t}\r\n\r\n\tvar varNames = [];\r\n\tvar varList = spec.split(\",\");\r\n\tvar varSpecs = [];\r\n\tvar varSpecMap = {};\r\n\tfor (var i = 0; i < varList.length; i++) {\r\n\t\tvar varName = varList[i];\r\n\t\tvar truncate = null;\r\n\t\tif (varName.indexOf(\":\") !== -1) {\r\n\t\t\tvar parts = varName.split(\":\");\r\n\t\t\tvarName = parts[0];\r\n\t\t\ttruncate = parseInt(parts[1], 10);\r\n\t\t}\r\n\t\tvar suffices = {};\r\n\t\twhile (uriTemplateSuffices[varName.charAt(varName.length - 1)]) {\r\n\t\t\tsuffices[varName.charAt(varName.length - 1)] = true;\r\n\t\t\tvarName = varName.substring(0, varName.length - 1);\r\n\t\t}\r\n\t\tvar varSpec = {\r\n\t\t\ttruncate: truncate,\r\n\t\t\tname: varName,\r\n\t\t\tsuffices: suffices\r\n\t\t};\r\n\t\tvarSpecs.push(varSpec);\r\n\t\tvarSpecMap[varName] = varSpec;\r\n\t\tvarNames.push(varName);\r\n\t}\r\n\tvar subFunction = function (valueFunction) {\r\n\t\tvar result = \"\";\r\n\t\tvar startIndex = 0;\r\n\t\tfor (var i = 0; i < varSpecs.length; i++) {\r\n\t\t\tvar varSpec = varSpecs[i];\r\n\t\t\tvar value = valueFunction(varSpec.name);\r\n\t\t\tif (value === null || value === undefined || (Array.isArray(value) && value.length === 0) || (typeof value === 'object' && Object.keys(value).length === 0)) {\r\n\t\t\t\tstartIndex++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (i === startIndex) {\r\n\t\t\t\tresult += prefix;\r\n\t\t\t} else {\r\n\t\t\t\tresult += (separator || \",\");\r\n\t\t\t}\r\n\t\t\tif (Array.isArray(value)) {\r\n\t\t\t\tif (showVariables) {\r\n\t\t\t\t\tresult += varSpec.name + \"=\";\r\n\t\t\t\t}\r\n\t\t\t\tfor (var j = 0; j < value.length; j++) {\r\n\t\t\t\t\tif (j > 0) {\r\n\t\t\t\t\t\tresult += varSpec.suffices['*'] ? (separator || \",\") : \",\";\r\n\t\t\t\t\t\tif (varSpec.suffices['*'] && showVariables) {\r\n\t\t\t\t\t\t\tresult += varSpec.name + \"=\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(value[j]).replace(/!/g, \"%21\") : notReallyPercentEncode(value[j]);\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof value === \"object\") {\r\n\t\t\t\tif (showVariables && !varSpec.suffices['*']) {\r\n\t\t\t\t\tresult += varSpec.name + \"=\";\r\n\t\t\t\t}\r\n\t\t\t\tvar first = true;\r\n\t\t\t\tfor (var key in value) {\r\n\t\t\t\t\tif (!first) {\r\n\t\t\t\t\t\tresult += varSpec.suffices['*'] ? (separator || \",\") : \",\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfirst = false;\r\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(key).replace(/!/g, \"%21\") : notReallyPercentEncode(key);\r\n\t\t\t\t\tresult += varSpec.suffices['*'] ? '=' : \",\";\r\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(value[key]).replace(/!/g, \"%21\") : notReallyPercentEncode(value[key]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (showVariables) {\r\n\t\t\t\t\tresult += varSpec.name;\r\n\t\t\t\t\tif (!trimEmptyString || value !== \"\") {\r\n\t\t\t\t\t\tresult += \"=\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (varSpec.truncate != null) {\r\n\t\t\t\t\tvalue = value.substring(0, varSpec.truncate);\r\n\t\t\t\t}\r\n\t\t\t\tresult += shouldEscape ? encodeURIComponent(value).replace(/!/g, \"%21\"): notReallyPercentEncode(value);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\tsubFunction.varNames = varNames;\r\n\treturn {\r\n\t\tprefix: prefix,\r\n\t\tsubstitution: subFunction\r\n\t};\r\n}\r\n\r\nfunction UriTemplate(template) {\r\n\tif (!(this instanceof UriTemplate)) {\r\n\t\treturn new UriTemplate(template);\r\n\t}\r\n\tvar parts = template.split(\"{\");\r\n\tvar textParts = [parts.shift()];\r\n\tvar prefixes = [];\r\n\tvar substitutions = [];\r\n\tvar varNames = [];\r\n\twhile (parts.length > 0) {\r\n\t\tvar part = parts.shift();\r\n\t\tvar spec = part.split(\"}\")[0];\r\n\t\tvar remainder = part.substring(spec.length + 1);\r\n\t\tvar funcs = uriTemplateSubstitution(spec);\r\n\t\tsubstitutions.push(funcs.substitution);\r\n\t\tprefixes.push(funcs.prefix);\r\n\t\ttextParts.push(remainder);\r\n\t\tvarNames = varNames.concat(funcs.substitution.varNames);\r\n\t}\r\n\tthis.fill = function (valueFunction) {\r\n\t\tvar result = textParts[0];\r\n\t\tfor (var i = 0; i < substitutions.length; i++) {\r\n\t\t\tvar substitution = substitutions[i];\r\n\t\t\tresult += substitution(valueFunction);\r\n\t\t\tresult += textParts[i + 1];\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\tthis.varNames = varNames;\r\n\tthis.template = template;\r\n}\r\nUriTemplate.prototype = {\r\n\ttoString: function () {\r\n\t\treturn this.template;\r\n\t},\r\n\tfillFromObject: function (obj) {\r\n\t\treturn this.fill(function (varName) {\r\n\t\t\treturn obj[varName];\r\n\t\t});\r\n\t}\r\n};\r\nvar ValidatorContext = function ValidatorContext(parent, collectMultiple, errorReporter, checkRecursive, trackUnknownProperties) {\r\n\tthis.missing = [];\r\n\tthis.missingMap = {};\r\n\tthis.formatValidators = parent ? Object.create(parent.formatValidators) : {};\r\n\tthis.schemas = parent ? Object.create(parent.schemas) : {};\r\n\tthis.collectMultiple = collectMultiple;\r\n\tthis.errors = [];\r\n\tthis.handleError = collectMultiple ? this.collectError : this.returnError;\r\n\tif (checkRecursive) {\r\n\t\tthis.checkRecursive = true;\r\n\t\tthis.scanned = [];\r\n\t\tthis.scannedFrozen = [];\r\n\t\tthis.scannedFrozenSchemas = [];\r\n\t\tthis.scannedFrozenValidationErrors = [];\r\n\t\tthis.validatedSchemasKey = 'tv4_validation_id';\r\n\t\tthis.validationErrorsKey = 'tv4_validation_errors_id';\r\n\t}\r\n\tif (trackUnknownProperties) {\r\n\t\tthis.trackUnknownProperties = true;\r\n\t\tthis.knownPropertyPaths = {};\r\n\t\tthis.unknownPropertyPaths = {};\r\n\t}\r\n\tthis.errorReporter = errorReporter || defaultErrorReporter('en');\r\n\tif (typeof this.errorReporter === 'string') {\r\n\t\tthrow new Error('debug');\r\n\t}\r\n\tthis.definedKeywords = {};\r\n\tif (parent) {\r\n\t\tfor (var key in parent.definedKeywords) {\r\n\t\t\tthis.definedKeywords[key] = parent.definedKeywords[key].slice(0);\r\n\t\t}\r\n\t}\r\n};\r\nValidatorContext.prototype.defineKeyword = function (keyword, keywordFunction) {\r\n\tthis.definedKeywords[keyword] = this.definedKeywords[keyword] || [];\r\n\tthis.definedKeywords[keyword].push(keywordFunction);\r\n};\r\nValidatorContext.prototype.createError = function (code, messageParams, dataPath, schemaPath, subErrors, data, schema) {\r\n\tvar error = new ValidationError(code, messageParams, dataPath, schemaPath, subErrors);\r\n\terror.message = this.errorReporter(error, data, schema);\r\n\treturn error;\r\n};\r\nValidatorContext.prototype.returnError = function (error) {\r\n\treturn error;\r\n};\r\nValidatorContext.prototype.collectError = function (error) {\r\n\tif (error) {\r\n\t\tthis.errors.push(error);\r\n\t}\r\n\treturn null;\r\n};\r\nValidatorContext.prototype.prefixErrors = function (startIndex, dataPath, schemaPath) {\r\n\tfor (var i = startIndex; i < this.errors.length; i++) {\r\n\t\tthis.errors[i] = this.errors[i].prefixWith(dataPath, schemaPath);\r\n\t}\r\n\treturn this;\r\n};\r\nValidatorContext.prototype.banUnknownProperties = function (data, schema) {\r\n\tfor (var unknownPath in this.unknownPropertyPaths) {\r\n\t\tvar error = this.createError(ErrorCodes.UNKNOWN_PROPERTY, {path: unknownPath}, unknownPath, \"\", null, data, schema);\r\n\t\tvar result = this.handleError(error);\r\n\t\tif (result) {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.addFormat = function (format, validator) {\r\n\tif (typeof format === 'object') {\r\n\t\tfor (var key in format) {\r\n\t\t\tthis.addFormat(key, format[key]);\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\tthis.formatValidators[format] = validator;\r\n};\r\nValidatorContext.prototype.resolveRefs = function (schema, urlHistory) {\r\n\tif (schema['$ref'] !== undefined) {\r\n\t\turlHistory = urlHistory || {};\r\n\t\tif (urlHistory[schema['$ref']]) {\r\n\t\t\treturn this.createError(ErrorCodes.CIRCULAR_REFERENCE, {urls: Object.keys(urlHistory).join(', ')}, '', '', null, undefined, schema);\r\n\t\t}\r\n\t\turlHistory[schema['$ref']] = true;\r\n\t\tschema = this.getSchema(schema['$ref'], urlHistory);\r\n\t}\r\n\treturn schema;\r\n};\r\nValidatorContext.prototype.getSchema = function (url, urlHistory) {\r\n\tvar schema;\r\n\tif (this.schemas[url] !== undefined) {\r\n\t\tschema = this.schemas[url];\r\n\t\treturn this.resolveRefs(schema, urlHistory);\r\n\t}\r\n\tvar baseUrl = url;\r\n\tvar fragment = \"\";\r\n\tif (url.indexOf('#') !== -1) {\r\n\t\tfragment = url.substring(url.indexOf(\"#\") + 1);\r\n\t\tbaseUrl = url.substring(0, url.indexOf(\"#\"));\r\n\t}\r\n\tif (typeof this.schemas[baseUrl] === 'object') {\r\n\t\tschema = this.schemas[baseUrl];\r\n\t\tvar pointerPath = decodeURIComponent(fragment);\r\n\t\tif (pointerPath === \"\") {\r\n\t\t\treturn this.resolveRefs(schema, urlHistory);\r\n\t\t} else if (pointerPath.charAt(0) !== \"/\") {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\tvar parts = pointerPath.split(\"/\").slice(1);\r\n\t\tfor (var i = 0; i < parts.length; i++) {\r\n\t\t\tvar component = parts[i].replace(/~1/g, \"/\").replace(/~0/g, \"~\");\r\n\t\t\tif (schema[component] === undefined) {\r\n\t\t\t\tschema = undefined;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tschema = schema[component];\r\n\t\t}\r\n\t\tif (schema !== undefined) {\r\n\t\t\treturn this.resolveRefs(schema, urlHistory);\r\n\t\t}\r\n\t}\r\n\tif (this.missing[baseUrl] === undefined) {\r\n\t\tthis.missing.push(baseUrl);\r\n\t\tthis.missing[baseUrl] = baseUrl;\r\n\t\tthis.missingMap[baseUrl] = baseUrl;\r\n\t}\r\n};\r\nValidatorContext.prototype.searchSchemas = function (schema, url) {\r\n\tif (Array.isArray(schema)) {\r\n\t\tfor (var i = 0; i < schema.length; i++) {\r\n\t\t\tthis.searchSchemas(schema[i], url);\r\n\t\t}\r\n\t} else if (schema && typeof schema === \"object\") {\r\n\t\tif (typeof schema.id === \"string\") {\r\n\t\t\tif (isTrustedUrl(url, schema.id)) {\r\n\t\t\t\tif (this.schemas[schema.id] === undefined) {\r\n\t\t\t\t\tthis.schemas[schema.id] = schema;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var key in schema) {\r\n\t\t\tif (key !== \"enum\") {\r\n\t\t\t\tif (typeof schema[key] === \"object\") {\r\n\t\t\t\t\tthis.searchSchemas(schema[key], url);\r\n\t\t\t\t} else if (key === \"$ref\") {\r\n\t\t\t\t\tvar uri = getDocumentUri(schema[key]);\r\n\t\t\t\t\tif (uri && this.schemas[uri] === undefined && this.missingMap[uri] === undefined) {\r\n\t\t\t\t\t\tthis.missingMap[uri] = uri;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\nValidatorContext.prototype.addSchema = function (url, schema) {\r\n\t//overload\r\n\tif (typeof url !== 'string' || typeof schema === 'undefined') {\r\n\t\tif (typeof url === 'object' && typeof url.id === 'string') {\r\n\t\t\tschema = url;\r\n\t\t\turl = schema.id;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif (url === getDocumentUri(url) + \"#\") {\r\n\t\t// Remove empty fragment\r\n\t\turl = getDocumentUri(url);\r\n\t}\r\n\tthis.schemas[url] = schema;\r\n\tdelete this.missingMap[url];\r\n\tnormSchema(schema, url);\r\n\tthis.searchSchemas(schema, url);\r\n};\r\n\r\nValidatorContext.prototype.getSchemaMap = function () {\r\n\tvar map = {};\r\n\tfor (var key in this.schemas) {\r\n\t\tmap[key] = this.schemas[key];\r\n\t}\r\n\treturn map;\r\n};\r\n\r\nValidatorContext.prototype.getSchemaUris = function (filterRegExp) {\r\n\tvar list = [];\r\n\tfor (var key in this.schemas) {\r\n\t\tif (!filterRegExp || filterRegExp.test(key)) {\r\n\t\t\tlist.push(key);\r\n\t\t}\r\n\t}\r\n\treturn list;\r\n};\r\n\r\nValidatorContext.prototype.getMissingUris = function (filterRegExp) {\r\n\tvar list = [];\r\n\tfor (var key in this.missingMap) {\r\n\t\tif (!filterRegExp || filterRegExp.test(key)) {\r\n\t\t\tlist.push(key);\r\n\t\t}\r\n\t}\r\n\treturn list;\r\n};\r\n\r\nValidatorContext.prototype.dropSchemas = function () {\r\n\tthis.schemas = {};\r\n\tthis.reset();\r\n};\r\nValidatorContext.prototype.reset = function () {\r\n\tthis.missing = [];\r\n\tthis.missingMap = {};\r\n\tthis.errors = [];\r\n};\r\n\r\nValidatorContext.prototype.validateAll = function (data, schema, dataPathParts, schemaPathParts, dataPointerPath) {\r\n\tvar topLevel;\r\n\tschema = this.resolveRefs(schema);\r\n\tif (!schema) {\r\n\t\treturn null;\r\n\t} else if (schema instanceof ValidationError) {\r\n\t\tthis.errors.push(schema);\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tvar startErrorCount = this.errors.length;\r\n\tvar frozenIndex, scannedFrozenSchemaIndex = null, scannedSchemasIndex = null;\r\n\tif (this.checkRecursive && data && typeof data === 'object') {\r\n\t\ttopLevel = !this.scanned.length;\r\n\t\tif (data[this.validatedSchemasKey]) {\r\n\t\t\tvar schemaIndex = data[this.validatedSchemasKey].indexOf(schema);\r\n\t\t\tif (schemaIndex !== -1) {\r\n\t\t\t\tthis.errors = this.errors.concat(data[this.validationErrorsKey][schemaIndex]);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (Object.isFrozen(data)) {\r\n\t\t\tfrozenIndex = this.scannedFrozen.indexOf(data);\r\n\t\t\tif (frozenIndex !== -1) {\r\n\t\t\t\tvar frozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].indexOf(schema);\r\n\t\t\t\tif (frozenSchemaIndex !== -1) {\r\n\t\t\t\t\tthis.errors = this.errors.concat(this.scannedFrozenValidationErrors[frozenIndex][frozenSchemaIndex]);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.scanned.push(data);\r\n\t\tif (Object.isFrozen(data)) {\r\n\t\t\tif (frozenIndex === -1) {\r\n\t\t\t\tfrozenIndex = this.scannedFrozen.length;\r\n\t\t\t\tthis.scannedFrozen.push(data);\r\n\t\t\t\tthis.scannedFrozenSchemas.push([]);\r\n\t\t\t}\r\n\t\t\tscannedFrozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].length;\r\n\t\t\tthis.scannedFrozenSchemas[frozenIndex][scannedFrozenSchemaIndex] = schema;\r\n\t\t\tthis.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = [];\r\n\t\t} else {\r\n\t\t\tif (!data[this.validatedSchemasKey]) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tObject.defineProperty(data, this.validatedSchemasKey, {\r\n\t\t\t\t\t\tvalue: [],\r\n\t\t\t\t\t\tconfigurable: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\tObject.defineProperty(data, this.validationErrorsKey, {\r\n\t\t\t\t\t\tvalue: [],\r\n\t\t\t\t\t\tconfigurable: true\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\t//IE 7/8 workaround\r\n\t\t\t\t\tdata[this.validatedSchemasKey] = [];\r\n\t\t\t\t\tdata[this.validationErrorsKey] = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tscannedSchemasIndex = data[this.validatedSchemasKey].length;\r\n\t\t\tdata[this.validatedSchemasKey][scannedSchemasIndex] = schema;\r\n\t\t\tdata[this.validationErrorsKey][scannedSchemasIndex] = [];\r\n\t\t}\r\n\t}\r\n\r\n\tvar errorCount = this.errors.length;\r\n\tvar error = this.validateBasic(data, schema, dataPointerPath)\r\n\t\t|| this.validateNumeric(data, schema, dataPointerPath)\r\n\t\t|| this.validateString(data, schema, dataPointerPath)\r\n\t\t|| this.validateArray(data, schema, dataPointerPath)\r\n\t\t|| this.validateObject(data, schema, dataPointerPath)\r\n\t\t|| this.validateCombinations(data, schema, dataPointerPath)\r\n\t\t|| this.validateHypermedia(data, schema, dataPointerPath)\r\n\t\t|| this.validateFormat(data, schema, dataPointerPath)\r\n\t\t|| this.validateDefinedKeywords(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n\r\n\tif (topLevel) {\r\n\t\twhile (this.scanned.length) {\r\n\t\t\tvar item = this.scanned.pop();\r\n\t\t\tdelete item[this.validatedSchemasKey];\r\n\t\t}\r\n\t\tthis.scannedFrozen = [];\r\n\t\tthis.scannedFrozenSchemas = [];\r\n\t}\r\n\r\n\tif (error || errorCount !== this.errors.length) {\r\n\t\twhile ((dataPathParts && dataPathParts.length) || (schemaPathParts && schemaPathParts.length)) {\r\n\t\t\tvar dataPart = (dataPathParts && dataPathParts.length) ? \"\" + dataPathParts.pop() : null;\r\n\t\t\tvar schemaPart = (schemaPathParts && schemaPathParts.length) ? \"\" + schemaPathParts.pop() : null;\r\n\t\t\tif (error) {\r\n\t\t\t\terror = error.prefixWith(dataPart, schemaPart);\r\n\t\t\t}\r\n\t\t\tthis.prefixErrors(errorCount, dataPart, schemaPart);\r\n\t\t}\r\n\t}\r\n\r\n\tif (scannedFrozenSchemaIndex !== null) {\r\n\t\tthis.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = this.errors.slice(startErrorCount);\r\n\t} else if (scannedSchemasIndex !== null) {\r\n\t\tdata[this.validationErrorsKey][scannedSchemasIndex] = this.errors.slice(startErrorCount);\r\n\t}\r\n\r\n\treturn this.handleError(error);\r\n};\r\nValidatorContext.prototype.validateFormat = function (data, schema) {\r\n\tif (typeof schema.format !== 'string' || !this.formatValidators[schema.format]) {\r\n\t\treturn null;\r\n\t}\r\n\tvar errorMessage = this.formatValidators[schema.format].call(null, data, schema);\r\n\tif (typeof errorMessage === 'string' || typeof errorMessage === 'number') {\r\n\t\treturn this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage}, '', '/format', null, data, schema);\r\n\t} else if (errorMessage && typeof errorMessage === 'object') {\r\n\t\treturn this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage.message || \"?\"}, errorMessage.dataPath || '', errorMessage.schemaPath || \"/format\", null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\nValidatorContext.prototype.validateDefinedKeywords = function (data, schema, dataPointerPath) {\r\n\tfor (var key in this.definedKeywords) {\r\n\t\tif (typeof schema[key] === 'undefined') {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tvar validationFunctions = this.definedKeywords[key];\r\n\t\tfor (var i = 0; i < validationFunctions.length; i++) {\r\n\t\t\tvar func = validationFunctions[i];\r\n\t\t\tvar result = func(data, schema[key], schema, dataPointerPath);\r\n\t\t\tif (typeof result === 'string' || typeof result === 'number') {\r\n\t\t\t\treturn this.createError(ErrorCodes.KEYWORD_CUSTOM, {key: key, message: result}, '', '', null, data, schema).prefixWith(null, key);\r\n\t\t\t} else if (result && typeof result === 'object') {\r\n\t\t\t\tvar code = result.code;\r\n\t\t\t\tif (typeof code === 'string') {\r\n\t\t\t\t\tif (!ErrorCodes[code]) {\r\n\t\t\t\t\t\tthrow new Error('Undefined error code (use defineError): ' + code);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcode = ErrorCodes[code];\r\n\t\t\t\t} else if (typeof code !== 'number') {\r\n\t\t\t\t\tcode = ErrorCodes.KEYWORD_CUSTOM;\r\n\t\t\t\t}\r\n\t\t\t\tvar messageParams = (typeof result.message === 'object') ? result.message : {key: key, message: result.message || \"?\"};\r\n\t\t\t\tvar schemaPath = result.schemaPath || (\"/\" + key.replace(/~/g, '~0').replace(/\\//g, '~1'));\r\n\t\t\t\treturn this.createError(code, messageParams, result.dataPath || null, schemaPath, null, data, schema);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nfunction recursiveCompare(A, B) {\r\n\tif (A === B) {\r\n\t\treturn true;\r\n\t}\r\n\tif (A && B && typeof A === \"object\" && typeof B === \"object\") {\r\n\t\tif (Array.isArray(A) !== Array.isArray(B)) {\r\n\t\t\treturn false;\r\n\t\t} else if (Array.isArray(A)) {\r\n\t\t\tif (A.length !== B.length) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < A.length; i++) {\r\n\t\t\t\tif (!recursiveCompare(A[i], B[i])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar key;\r\n\t\t\tfor (key in A) {\r\n\t\t\t\tif (B[key] === undefined && A[key] !== undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (key in B) {\r\n\t\t\t\tif (A[key] === undefined && B[key] !== undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (key in A) {\r\n\t\t\t\tif (!recursiveCompare(A[key], B[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValidatorContext.prototype.validateBasic = function validateBasic(data, schema, dataPointerPath) {\r\n\tvar error;\r\n\tif (error = this.validateType(data, schema, dataPointerPath)) {\r\n\t\treturn error.prefixWith(null, \"type\");\r\n\t}\r\n\tif (error = this.validateEnum(data, schema, dataPointerPath)) {\r\n\t\treturn error.prefixWith(null, \"type\");\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateType = function validateType(data, schema) {\r\n\tif (schema.type === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar dataType = typeof data;\r\n\tif (data === null) {\r\n\t\tdataType = \"null\";\r\n\t} else if (Array.isArray(data)) {\r\n\t\tdataType = \"array\";\r\n\t}\r\n\tvar allowedTypes = schema.type;\r\n\tif (!Array.isArray(allowedTypes)) {\r\n\t\tallowedTypes = [allowedTypes];\r\n\t}\r\n\r\n\tfor (var i = 0; i < allowedTypes.length; i++) {\r\n\t\tvar type = allowedTypes[i];\r\n\t\tif (type === dataType || (type === \"integer\" && dataType === \"number\" && (data % 1 === 0))) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\treturn this.createError(ErrorCodes.INVALID_TYPE, {type: dataType, expected: allowedTypes.join(\"/\")}, '', '', null, data, schema);\r\n};\r\n\r\nValidatorContext.prototype.validateEnum = function validateEnum(data, schema) {\r\n\tif (schema[\"enum\"] === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tfor (var i = 0; i < schema[\"enum\"].length; i++) {\r\n\t\tvar enumVal = schema[\"enum\"][i];\r\n\t\tif (recursiveCompare(data, enumVal)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\treturn this.createError(ErrorCodes.ENUM_MISMATCH, {value: (typeof JSON !== 'undefined') ? JSON.stringify(data) : data}, '', '', null, data, schema);\r\n};\r\n\r\nValidatorContext.prototype.validateNumeric = function validateNumeric(data, schema, dataPointerPath) {\r\n\treturn this.validateMultipleOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateMinMax(data, schema, dataPointerPath)\r\n\t\t|| this.validateNaN(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nvar CLOSE_ENOUGH_LOW = Math.pow(2, -51);\r\nvar CLOSE_ENOUGH_HIGH = 1 - CLOSE_ENOUGH_LOW;\r\nValidatorContext.prototype.validateMultipleOf = function validateMultipleOf(data, schema) {\r\n\tvar multipleOf = schema.multipleOf || schema.divisibleBy;\r\n\tif (multipleOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tif (typeof data === \"number\") {\r\n\t\tvar remainder = (data/multipleOf)%1;\r\n\t\tif (remainder >= CLOSE_ENOUGH_LOW && remainder < CLOSE_ENOUGH_HIGH) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MULTIPLE_OF, {value: data, multipleOf: multipleOf}, '', '', null, data, schema);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateMinMax = function validateMinMax(data, schema) {\r\n\tif (typeof data !== \"number\") {\r\n\t\treturn null;\r\n\t}\r\n\tif (schema.minimum !== undefined) {\r\n\t\tif (data < schema.minimum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MINIMUM, {value: data, minimum: schema.minimum}, '', '/minimum', null, data, schema);\r\n\t\t}\r\n\t\tif (schema.exclusiveMinimum && data === schema.minimum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MINIMUM_EXCLUSIVE, {value: data, minimum: schema.minimum}, '', '/exclusiveMinimum', null, data, schema);\r\n\t\t}\r\n\t}\r\n\tif (schema.maximum !== undefined) {\r\n\t\tif (data > schema.maximum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MAXIMUM, {value: data, maximum: schema.maximum}, '', '/maximum', null, data, schema);\r\n\t\t}\r\n\t\tif (schema.exclusiveMaximum && data === schema.maximum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MAXIMUM_EXCLUSIVE, {value: data, maximum: schema.maximum}, '', '/exclusiveMaximum', null, data, schema);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateNaN = function validateNaN(data, schema) {\r\n\tif (typeof data !== \"number\") {\r\n\t\treturn null;\r\n\t}\r\n\tif (isNaN(data) === true || data === Infinity || data === -Infinity) {\r\n\t\treturn this.createError(ErrorCodes.NUMBER_NOT_A_NUMBER, {value: data}, '', '/type', null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateString = function validateString(data, schema, dataPointerPath) {\r\n\treturn this.validateStringLength(data, schema, dataPointerPath)\r\n\t\t|| this.validateStringPattern(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateStringLength = function validateStringLength(data, schema) {\r\n\tif (typeof data !== \"string\") {\r\n\t\treturn null;\r\n\t}\r\n\tif (schema.minLength !== undefined) {\r\n\t\tif (data.length < schema.minLength) {\r\n\t\t\treturn this.createError(ErrorCodes.STRING_LENGTH_SHORT, {length: data.length, minimum: schema.minLength}, '', '/minLength', null, data, schema);\r\n\t\t}\r\n\t}\r\n\tif (schema.maxLength !== undefined) {\r\n\t\tif (data.length > schema.maxLength) {\r\n\t\t\treturn this.createError(ErrorCodes.STRING_LENGTH_LONG, {length: data.length, maximum: schema.maxLength}, '', '/maxLength', null, data, schema);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateStringPattern = function validateStringPattern(data, schema) {\r\n\tif (typeof data !== \"string\" || (typeof schema.pattern !== \"string\" && !(schema.pattern instanceof RegExp))) {\r\n\t\treturn null;\r\n\t}\r\n\tvar regexp;\r\n\tif (schema.pattern instanceof RegExp) {\r\n\t  regexp = schema.pattern;\r\n\t}\r\n\telse {\r\n\t  var body, flags = '';\r\n\t  // Check for regular expression literals\r\n\t  // @see http://www.ecma-international.org/ecma-262/5.1/#sec-7.8.5\r\n\t  var literal = schema.pattern.match(/^\\/(.+)\\/([img]*)$/);\r\n\t  if (literal) {\r\n\t    body = literal[1];\r\n\t    flags = literal[2];\r\n\t  }\r\n\t  else {\r\n\t    body = schema.pattern;\r\n\t  }\r\n\t  regexp = new RegExp(body, flags);\r\n\t}\r\n\tif (!regexp.test(data)) {\r\n\t\treturn this.createError(ErrorCodes.STRING_PATTERN, {pattern: schema.pattern}, '', '/pattern', null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateArray = function validateArray(data, schema, dataPointerPath) {\r\n\tif (!Array.isArray(data)) {\r\n\t\treturn null;\r\n\t}\r\n\treturn this.validateArrayLength(data, schema, dataPointerPath)\r\n\t\t|| this.validateArrayUniqueItems(data, schema, dataPointerPath)\r\n\t\t|| this.validateArrayItems(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateArrayLength = function validateArrayLength(data, schema) {\r\n\tvar error;\r\n\tif (schema.minItems !== undefined) {\r\n\t\tif (data.length < schema.minItems) {\r\n\t\t\terror = this.createError(ErrorCodes.ARRAY_LENGTH_SHORT, {length: data.length, minimum: schema.minItems}, '', '/minItems', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (schema.maxItems !== undefined) {\r\n\t\tif (data.length > schema.maxItems) {\r\n\t\t\terror = this.createError(ErrorCodes.ARRAY_LENGTH_LONG, {length: data.length, maximum: schema.maxItems}, '', '/maxItems', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateArrayUniqueItems = function validateArrayUniqueItems(data, schema) {\r\n\tif (schema.uniqueItems) {\r\n\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\tfor (var j = i + 1; j < data.length; j++) {\r\n\t\t\t\tif (recursiveCompare(data[i], data[j])) {\r\n\t\t\t\t\tvar error = this.createError(ErrorCodes.ARRAY_UNIQUE, {match1: i, match2: j}, '', '/uniqueItems', null, data, schema);\r\n\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateArrayItems = function validateArrayItems(data, schema, dataPointerPath) {\r\n\tif (schema.items === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar error, i;\r\n\tif (Array.isArray(schema.items)) {\r\n\t\tfor (i = 0; i < data.length; i++) {\r\n\t\t\tif (i < schema.items.length) {\r\n\t\t\t\tif (error = this.validateAll(data[i], schema.items[i], [i], [\"items\", i], dataPointerPath + \"/\" + i)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t} else if (schema.additionalItems !== undefined) {\r\n\t\t\t\tif (typeof schema.additionalItems === \"boolean\") {\r\n\t\t\t\t\tif (!schema.additionalItems) {\r\n\t\t\t\t\t\terror = (this.createError(ErrorCodes.ARRAY_ADDITIONAL_ITEMS, {}, '/' + i, '/additionalItems', null, data, schema));\r\n\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (error = this.validateAll(data[i], schema.additionalItems, [i], [\"additionalItems\"], dataPointerPath + \"/\" + i)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (i = 0; i < data.length; i++) {\r\n\t\t\tif (error = this.validateAll(data[i], schema.items, [i], [\"items\"], dataPointerPath + \"/\" + i)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObject = function validateObject(data, schema, dataPointerPath) {\r\n\tif (typeof data !== \"object\" || data === null || Array.isArray(data)) {\r\n\t\treturn null;\r\n\t}\r\n\treturn this.validateObjectMinMaxProperties(data, schema, dataPointerPath)\r\n\t\t|| this.validateObjectRequiredProperties(data, schema, dataPointerPath)\r\n\t\t|| this.validateObjectProperties(data, schema, dataPointerPath)\r\n\t\t|| this.validateObjectDependencies(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectMinMaxProperties = function validateObjectMinMaxProperties(data, schema) {\r\n\tvar keys = Object.keys(data);\r\n\tvar error;\r\n\tif (schema.minProperties !== undefined) {\r\n\t\tif (keys.length < schema.minProperties) {\r\n\t\t\terror = this.createError(ErrorCodes.OBJECT_PROPERTIES_MINIMUM, {propertyCount: keys.length, minimum: schema.minProperties}, '', '/minProperties', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (schema.maxProperties !== undefined) {\r\n\t\tif (keys.length > schema.maxProperties) {\r\n\t\t\terror = this.createError(ErrorCodes.OBJECT_PROPERTIES_MAXIMUM, {propertyCount: keys.length, maximum: schema.maxProperties}, '', '/maxProperties', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectRequiredProperties = function validateObjectRequiredProperties(data, schema) {\r\n\tif (schema.required !== undefined) {\r\n\t\tfor (var i = 0; i < schema.required.length; i++) {\r\n\t\t\tvar key = schema.required[i];\r\n\t\t\tif (data[key] === undefined) {\r\n\t\t\t\tvar error = this.createError(ErrorCodes.OBJECT_REQUIRED, {key: key}, '', '/required/' + i, null, data, schema);\r\n\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectProperties = function validateObjectProperties(data, schema, dataPointerPath) {\r\n\tvar error;\r\n\tfor (var key in data) {\r\n\t\tvar keyPointerPath = dataPointerPath + \"/\" + key.replace(/~/g, '~0').replace(/\\//g, '~1');\r\n\t\tvar foundMatch = false;\r\n\t\tif (schema.properties !== undefined && schema.properties[key] !== undefined) {\r\n\t\t\tfoundMatch = true;\r\n\t\t\tif (error = this.validateAll(data[key], schema.properties[key], [key], [\"properties\", key], keyPointerPath)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (schema.patternProperties !== undefined) {\r\n\t\t\tfor (var patternKey in schema.patternProperties) {\r\n\t\t\t\tvar regexp = new RegExp(patternKey);\r\n\t\t\t\tif (regexp.test(key)) {\r\n\t\t\t\t\tfoundMatch = true;\r\n\t\t\t\t\tif (error = this.validateAll(data[key], schema.patternProperties[patternKey], [key], [\"patternProperties\", patternKey], keyPointerPath)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!foundMatch) {\r\n\t\t\tif (schema.additionalProperties !== undefined) {\r\n\t\t\t\tif (this.trackUnknownProperties) {\r\n\t\t\t\t\tthis.knownPropertyPaths[keyPointerPath] = true;\r\n\t\t\t\t\tdelete this.unknownPropertyPaths[keyPointerPath];\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof schema.additionalProperties === \"boolean\") {\r\n\t\t\t\t\tif (!schema.additionalProperties) {\r\n\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_ADDITIONAL_PROPERTIES, {key: key}, '', '/additionalProperties', null, data, schema).prefixWith(key, null);\r\n\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (error = this.validateAll(data[key], schema.additionalProperties, [key], [\"additionalProperties\"], keyPointerPath)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (this.trackUnknownProperties && !this.knownPropertyPaths[keyPointerPath]) {\r\n\t\t\t\tthis.unknownPropertyPaths[keyPointerPath] = true;\r\n\t\t\t}\r\n\t\t} else if (this.trackUnknownProperties) {\r\n\t\t\tthis.knownPropertyPaths[keyPointerPath] = true;\r\n\t\t\tdelete this.unknownPropertyPaths[keyPointerPath];\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectDependencies = function validateObjectDependencies(data, schema, dataPointerPath) {\r\n\tvar error;\r\n\tif (schema.dependencies !== undefined) {\r\n\t\tfor (var depKey in schema.dependencies) {\r\n\t\t\tif (data[depKey] !== undefined) {\r\n\t\t\t\tvar dep = schema.dependencies[depKey];\r\n\t\t\t\tif (typeof dep === \"string\") {\r\n\t\t\t\t\tif (data[dep] === undefined) {\r\n\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {key: depKey, missing: dep}, '', '', null, data, schema).prefixWith(null, depKey).prefixWith(null, \"dependencies\");\r\n\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (Array.isArray(dep)) {\r\n\t\t\t\t\tfor (var i = 0; i < dep.length; i++) {\r\n\t\t\t\t\t\tvar requiredKey = dep[i];\r\n\t\t\t\t\t\tif (data[requiredKey] === undefined) {\r\n\t\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {key: depKey, missing: requiredKey}, '', '/' + i, null, data, schema).prefixWith(null, depKey).prefixWith(null, \"dependencies\");\r\n\t\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (error = this.validateAll(data, dep, [], [\"dependencies\", depKey], dataPointerPath)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateCombinations = function validateCombinations(data, schema, dataPointerPath) {\r\n\treturn this.validateAllOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateAnyOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateOneOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateNot(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateAllOf = function validateAllOf(data, schema, dataPointerPath) {\r\n\tif (schema.allOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar error;\r\n\tfor (var i = 0; i < schema.allOf.length; i++) {\r\n\t\tvar subSchema = schema.allOf[i];\r\n\t\tif (error = this.validateAll(data, subSchema, [], [\"allOf\", i], dataPointerPath)) {\r\n\t\t\treturn error;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateAnyOf = function validateAnyOf(data, schema, dataPointerPath) {\r\n\tif (schema.anyOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar errors = [];\r\n\tvar startErrorCount = this.errors.length;\r\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\r\n\tif (this.trackUnknownProperties) {\r\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\r\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\r\n\t}\r\n\tvar errorAtEnd = true;\r\n\tfor (var i = 0; i < schema.anyOf.length; i++) {\r\n\t\tif (this.trackUnknownProperties) {\r\n\t\t\tthis.unknownPropertyPaths = {};\r\n\t\t\tthis.knownPropertyPaths = {};\r\n\t\t}\r\n\t\tvar subSchema = schema.anyOf[i];\r\n\r\n\t\tvar errorCount = this.errors.length;\r\n\t\tvar error = this.validateAll(data, subSchema, [], [\"anyOf\", i], dataPointerPath);\r\n\r\n\t\tif (error === null && errorCount === this.errors.length) {\r\n\t\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\r\n\t\t\tif (this.trackUnknownProperties) {\r\n\t\t\t\tfor (var knownKey in this.knownPropertyPaths) {\r\n\t\t\t\t\toldKnownPropertyPaths[knownKey] = true;\r\n\t\t\t\t\tdelete oldUnknownPropertyPaths[knownKey];\r\n\t\t\t\t}\r\n\t\t\t\tfor (var unknownKey in this.unknownPropertyPaths) {\r\n\t\t\t\t\tif (!oldKnownPropertyPaths[unknownKey]) {\r\n\t\t\t\t\t\toldUnknownPropertyPaths[unknownKey] = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// We need to continue looping so we catch all the property definitions, but we don't want to return an error\r\n\t\t\t\terrorAtEnd = false;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (error) {\r\n\t\t\terrors.push(error.prefixWith(null, \"\" + i).prefixWith(null, \"anyOf\"));\r\n\t\t}\r\n\t}\r\n\tif (this.trackUnknownProperties) {\r\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\r\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\r\n\t}\r\n\tif (errorAtEnd) {\r\n\t\terrors = errors.concat(this.errors.slice(startErrorCount));\r\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t\treturn this.createError(ErrorCodes.ANY_OF_MISSING, {}, \"\", \"/anyOf\", errors, data, schema);\r\n\t}\r\n};\r\n\r\nValidatorContext.prototype.validateOneOf = function validateOneOf(data, schema, dataPointerPath) {\r\n\tif (schema.oneOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar validIndex = null;\r\n\tvar errors = [];\r\n\tvar startErrorCount = this.errors.length;\r\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\r\n\tif (this.trackUnknownProperties) {\r\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\r\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\r\n\t}\r\n\tfor (var i = 0; i < schema.oneOf.length; i++) {\r\n\t\tif (this.trackUnknownProperties) {\r\n\t\t\tthis.unknownPropertyPaths = {};\r\n\t\t\tthis.knownPropertyPaths = {};\r\n\t\t}\r\n\t\tvar subSchema = schema.oneOf[i];\r\n\r\n\t\tvar errorCount = this.errors.length;\r\n\t\tvar error = this.validateAll(data, subSchema, [], [\"oneOf\", i], dataPointerPath);\r\n\r\n\t\tif (error === null && errorCount === this.errors.length) {\r\n\t\t\tif (validIndex === null) {\r\n\t\t\t\tvalidIndex = i;\r\n\t\t\t} else {\r\n\t\t\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t\t\t\treturn this.createError(ErrorCodes.ONE_OF_MULTIPLE, {index1: validIndex, index2: i}, \"\", \"/oneOf\", null, data, schema);\r\n\t\t\t}\r\n\t\t\tif (this.trackUnknownProperties) {\r\n\t\t\t\tfor (var knownKey in this.knownPropertyPaths) {\r\n\t\t\t\t\toldKnownPropertyPaths[knownKey] = true;\r\n\t\t\t\t\tdelete oldUnknownPropertyPaths[knownKey];\r\n\t\t\t\t}\r\n\t\t\t\tfor (var unknownKey in this.unknownPropertyPaths) {\r\n\t\t\t\t\tif (!oldKnownPropertyPaths[unknownKey]) {\r\n\t\t\t\t\t\toldUnknownPropertyPaths[unknownKey] = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (error) {\r\n\t\t\terrors.push(error);\r\n\t\t}\r\n\t}\r\n\tif (this.trackUnknownProperties) {\r\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\r\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\r\n\t}\r\n\tif (validIndex === null) {\r\n\t\terrors = errors.concat(this.errors.slice(startErrorCount));\r\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t\treturn this.createError(ErrorCodes.ONE_OF_MISSING, {}, \"\", \"/oneOf\", errors, data, schema);\r\n\t} else {\r\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateNot = function validateNot(data, schema, dataPointerPath) {\r\n\tif (schema.not === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar oldErrorCount = this.errors.length;\r\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\r\n\tif (this.trackUnknownProperties) {\r\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\r\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\r\n\t\tthis.unknownPropertyPaths = {};\r\n\t\tthis.knownPropertyPaths = {};\r\n\t}\r\n\tvar error = this.validateAll(data, schema.not, null, null, dataPointerPath);\r\n\tvar notErrors = this.errors.slice(oldErrorCount);\r\n\tthis.errors = this.errors.slice(0, oldErrorCount);\r\n\tif (this.trackUnknownProperties) {\r\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\r\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\r\n\t}\r\n\tif (error === null && notErrors.length === 0) {\r\n\t\treturn this.createError(ErrorCodes.NOT_PASSED, {}, \"\", \"/not\", null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateHypermedia = function validateCombinations(data, schema, dataPointerPath) {\r\n\tif (!schema.links) {\r\n\t\treturn null;\r\n\t}\r\n\tvar error;\r\n\tfor (var i = 0; i < schema.links.length; i++) {\r\n\t\tvar ldo = schema.links[i];\r\n\t\tif (ldo.rel === \"describedby\") {\r\n\t\t\tvar template = new UriTemplate(ldo.href);\r\n\t\t\tvar allPresent = true;\r\n\t\t\tfor (var j = 0; j < template.varNames.length; j++) {\r\n\t\t\t\tif (!(template.varNames[j] in data)) {\r\n\t\t\t\t\tallPresent = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (allPresent) {\r\n\t\t\t\tvar schemaUrl = template.fillFromObject(data);\r\n\t\t\t\tvar subSchema = {\"$ref\": schemaUrl};\r\n\t\t\t\tif (error = this.validateAll(data, subSchema, [], [\"links\", i], dataPointerPath)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// parseURI() and resolveUrl() are from https://gist.github.com/1088850\r\n//   -  released as public domain by author (\"Yaffle\") - see comments on gist\r\n\r\nfunction parseURI(url) {\r\n\tvar m = String(url).replace(/^\\s+|\\s+$/g, '').match(/^([^:\\/?#]+:)?(\\/\\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\\/?#]*)(?::(\\d*))?))?([^?#]*)(\\?[^#]*)?(#[\\s\\S]*)?/);\r\n\t// authority = '//' + user + ':' + pass '@' + hostname + ':' port\r\n\treturn (m ? {\r\n\t\thref     : m[0] || '',\r\n\t\tprotocol : m[1] || '',\r\n\t\tauthority: m[2] || '',\r\n\t\thost     : m[3] || '',\r\n\t\thostname : m[4] || '',\r\n\t\tport     : m[5] || '',\r\n\t\tpathname : m[6] || '',\r\n\t\tsearch   : m[7] || '',\r\n\t\thash     : m[8] || ''\r\n\t} : null);\r\n}\r\n\r\nfunction resolveUrl(base, href) {// RFC 3986\r\n\r\n\tfunction removeDotSegments(input) {\r\n\t\tvar output = [];\r\n\t\tinput.replace(/^(\\.\\.?(\\/|$))+/, '')\r\n\t\t\t.replace(/\\/(\\.(\\/|$))+/g, '/')\r\n\t\t\t.replace(/\\/\\.\\.$/, '/../')\r\n\t\t\t.replace(/\\/?[^\\/]*/g, function (p) {\r\n\t\t\t\tif (p === '/..') {\r\n\t\t\t\t\toutput.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\toutput.push(p);\r\n\t\t\t\t}\r\n\t\t});\r\n\t\treturn output.join('').replace(/^\\//, input.charAt(0) === '/' ? '/' : '');\r\n\t}\r\n\r\n\thref = parseURI(href || '');\r\n\tbase = parseURI(base || '');\r\n\r\n\treturn !href || !base ? null : (href.protocol || base.protocol) +\r\n\t\t(href.protocol || href.authority ? href.authority : base.authority) +\r\n\t\tremoveDotSegments(href.protocol || href.authority || href.pathname.charAt(0) === '/' ? href.pathname : (href.pathname ? ((base.authority && !base.pathname ? '/' : '') + base.pathname.slice(0, base.pathname.lastIndexOf('/') + 1) + href.pathname) : base.pathname)) +\r\n\t\t(href.protocol || href.authority || href.pathname ? href.search : (href.search || base.search)) +\r\n\t\thref.hash;\r\n}\r\n\r\nfunction getDocumentUri(uri) {\r\n\treturn uri.split('#')[0];\r\n}\r\nfunction normSchema(schema, baseUri) {\r\n\tif (schema && typeof schema === \"object\") {\r\n\t\tif (baseUri === undefined) {\r\n\t\t\tbaseUri = schema.id;\r\n\t\t} else if (typeof schema.id === \"string\") {\r\n\t\t\tbaseUri = resolveUrl(baseUri, schema.id);\r\n\t\t\tschema.id = baseUri;\r\n\t\t}\r\n\t\tif (Array.isArray(schema)) {\r\n\t\t\tfor (var i = 0; i < schema.length; i++) {\r\n\t\t\t\tnormSchema(schema[i], baseUri);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (typeof schema['$ref'] === \"string\") {\r\n\t\t\t\tschema['$ref'] = resolveUrl(baseUri, schema['$ref']);\r\n\t\t\t}\r\n\t\t\tfor (var key in schema) {\r\n\t\t\t\tif (key !== \"enum\") {\r\n\t\t\t\t\tnormSchema(schema[key], baseUri);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction defaultErrorReporter(language) {\r\n\tlanguage = language || 'en';\r\n\r\n\tvar errorMessages = languages[language];\r\n\r\n\treturn function (error) {\r\n\t\tvar messageTemplate = errorMessages[error.code] || ErrorMessagesDefault[error.code];\r\n\t\tif (typeof messageTemplate !== 'string') {\r\n\t\t\treturn \"Unknown error code \" + error.code + \": \" + JSON.stringify(error.messageParams);\r\n\t\t}\r\n\t\tvar messageParams = error.params;\r\n\t\t// Adapted from Crockford's supplant()\r\n\t\treturn messageTemplate.replace(/\\{([^{}]*)\\}/g, function (whole, varName) {\r\n\t\t\tvar subValue = messageParams[varName];\r\n\t\t\treturn typeof subValue === 'string' || typeof subValue === 'number' ? subValue : whole;\r\n\t\t});\r\n\t};\r\n}\r\n\r\nvar ErrorCodes = {\r\n\tINVALID_TYPE: 0,\r\n\tENUM_MISMATCH: 1,\r\n\tANY_OF_MISSING: 10,\r\n\tONE_OF_MISSING: 11,\r\n\tONE_OF_MULTIPLE: 12,\r\n\tNOT_PASSED: 13,\r\n\t// Numeric errors\r\n\tNUMBER_MULTIPLE_OF: 100,\r\n\tNUMBER_MINIMUM: 101,\r\n\tNUMBER_MINIMUM_EXCLUSIVE: 102,\r\n\tNUMBER_MAXIMUM: 103,\r\n\tNUMBER_MAXIMUM_EXCLUSIVE: 104,\r\n\tNUMBER_NOT_A_NUMBER: 105,\r\n\t// String errors\r\n\tSTRING_LENGTH_SHORT: 200,\r\n\tSTRING_LENGTH_LONG: 201,\r\n\tSTRING_PATTERN: 202,\r\n\t// Object errors\r\n\tOBJECT_PROPERTIES_MINIMUM: 300,\r\n\tOBJECT_PROPERTIES_MAXIMUM: 301,\r\n\tOBJECT_REQUIRED: 302,\r\n\tOBJECT_ADDITIONAL_PROPERTIES: 303,\r\n\tOBJECT_DEPENDENCY_KEY: 304,\r\n\t// Array errors\r\n\tARRAY_LENGTH_SHORT: 400,\r\n\tARRAY_LENGTH_LONG: 401,\r\n\tARRAY_UNIQUE: 402,\r\n\tARRAY_ADDITIONAL_ITEMS: 403,\r\n\t// Custom/user-defined errors\r\n\tFORMAT_CUSTOM: 500,\r\n\tKEYWORD_CUSTOM: 501,\r\n\t// Schema structure\r\n\tCIRCULAR_REFERENCE: 600,\r\n\t// Non-standard validation options\r\n\tUNKNOWN_PROPERTY: 1000\r\n};\r\nvar ErrorCodeLookup = {};\r\nfor (var key in ErrorCodes) {\r\n\tErrorCodeLookup[ErrorCodes[key]] = key;\r\n}\r\nvar ErrorMessagesDefault = {\r\n\tINVALID_TYPE: \"Invalid type: {type} (expected {expected})\",\r\n\tENUM_MISMATCH: \"No enum match for: {value}\",\r\n\tANY_OF_MISSING: \"Data does not match any schemas from \\\"anyOf\\\"\",\r\n\tONE_OF_MISSING: \"Data does not match any schemas from \\\"oneOf\\\"\",\r\n\tONE_OF_MULTIPLE: \"Data is valid against more than one schema from \\\"oneOf\\\": indices {index1} and {index2}\",\r\n\tNOT_PASSED: \"Data matches schema from \\\"not\\\"\",\r\n\t// Numeric errors\r\n\tNUMBER_MULTIPLE_OF: \"Value {value} is not a multiple of {multipleOf}\",\r\n\tNUMBER_MINIMUM: \"Value {value} is less than minimum {minimum}\",\r\n\tNUMBER_MINIMUM_EXCLUSIVE: \"Value {value} is equal to exclusive minimum {minimum}\",\r\n\tNUMBER_MAXIMUM: \"Value {value} is greater than maximum {maximum}\",\r\n\tNUMBER_MAXIMUM_EXCLUSIVE: \"Value {value} is equal to exclusive maximum {maximum}\",\r\n\tNUMBER_NOT_A_NUMBER: \"Value {value} is not a valid number\",\r\n\t// String errors\r\n\tSTRING_LENGTH_SHORT: \"String is too short ({length} chars), minimum {minimum}\",\r\n\tSTRING_LENGTH_LONG: \"String is too long ({length} chars), maximum {maximum}\",\r\n\tSTRING_PATTERN: \"String does not match pattern: {pattern}\",\r\n\t// Object errors\r\n\tOBJECT_PROPERTIES_MINIMUM: \"Too few properties defined ({propertyCount}), minimum {minimum}\",\r\n\tOBJECT_PROPERTIES_MAXIMUM: \"Too many properties defined ({propertyCount}), maximum {maximum}\",\r\n\tOBJECT_REQUIRED: \"Missing required property: {key}\",\r\n\tOBJECT_ADDITIONAL_PROPERTIES: \"Additional properties not allowed\",\r\n\tOBJECT_DEPENDENCY_KEY: \"Dependency failed - key must exist: {missing} (due to key: {key})\",\r\n\t// Array errors\r\n\tARRAY_LENGTH_SHORT: \"Array is too short ({length}), minimum {minimum}\",\r\n\tARRAY_LENGTH_LONG: \"Array is too long ({length}), maximum {maximum}\",\r\n\tARRAY_UNIQUE: \"Array items are not unique (indices {match1} and {match2})\",\r\n\tARRAY_ADDITIONAL_ITEMS: \"Additional items not allowed\",\r\n\t// Format errors\r\n\tFORMAT_CUSTOM: \"Format validation failed ({message})\",\r\n\tKEYWORD_CUSTOM: \"Keyword failed: {key} ({message})\",\r\n\t// Schema structure\r\n\tCIRCULAR_REFERENCE: \"Circular $refs: {urls}\",\r\n\t// Non-standard validation options\r\n\tUNKNOWN_PROPERTY: \"Unknown property (not in schema)\"\r\n};\r\n\r\nfunction ValidationError(code, params, dataPath, schemaPath, subErrors) {\r\n\tError.call(this);\r\n\tif (code === undefined) {\r\n\t\tthrow new Error (\"No error code supplied: \" + schemaPath);\r\n\t}\r\n\tthis.message = '';\r\n\tthis.params = params;\r\n\tthis.code = code;\r\n\tthis.dataPath = dataPath || \"\";\r\n\tthis.schemaPath = schemaPath || \"\";\r\n\tthis.subErrors = subErrors || null;\r\n\r\n\tvar err = new Error(this.message);\r\n\tthis.stack = err.stack || err.stacktrace;\r\n\tif (!this.stack) {\r\n\t\ttry {\r\n\t\t\tthrow err;\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthis.stack = err.stack || err.stacktrace;\r\n\t\t}\r\n\t}\r\n}\r\nValidationError.prototype = Object.create(Error.prototype);\r\nValidationError.prototype.constructor = ValidationError;\r\nValidationError.prototype.name = 'ValidationError';\r\n\r\nValidationError.prototype.prefixWith = function (dataPrefix, schemaPrefix) {\r\n\tif (dataPrefix !== null) {\r\n\t\tdataPrefix = dataPrefix.replace(/~/g, \"~0\").replace(/\\//g, \"~1\");\r\n\t\tthis.dataPath = \"/\" + dataPrefix + this.dataPath;\r\n\t}\r\n\tif (schemaPrefix !== null) {\r\n\t\tschemaPrefix = schemaPrefix.replace(/~/g, \"~0\").replace(/\\//g, \"~1\");\r\n\t\tthis.schemaPath = \"/\" + schemaPrefix + this.schemaPath;\r\n\t}\r\n\tif (this.subErrors !== null) {\r\n\t\tfor (var i = 0; i < this.subErrors.length; i++) {\r\n\t\t\tthis.subErrors[i].prefixWith(dataPrefix, schemaPrefix);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nfunction isTrustedUrl(baseUrl, testUrl) {\r\n\tif(testUrl.substring(0, baseUrl.length) === baseUrl){\r\n\t\tvar remainder = testUrl.substring(baseUrl.length);\r\n\t\tif ((testUrl.length > 0 && testUrl.charAt(baseUrl.length - 1) === \"/\")\r\n\t\t\t|| remainder.charAt(0) === \"#\"\r\n\t\t\t|| remainder.charAt(0) === \"?\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nvar languages = {};\r\nfunction createApi(language) {\r\n\tvar globalContext = new ValidatorContext();\r\n\tvar currentLanguage;\r\n\tvar customErrorReporter;\r\n\tvar api = {\r\n\t\tsetErrorReporter: function (reporter) {\r\n\t\t\tif (typeof reporter === 'string') {\r\n\t\t\t\treturn this.language(reporter);\r\n\t\t\t}\r\n\t\t\tcustomErrorReporter = reporter;\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\taddFormat: function () {\r\n\t\t\tglobalContext.addFormat.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tlanguage: function (code) {\r\n\t\t\tif (!code) {\r\n\t\t\t\treturn currentLanguage;\r\n\t\t\t}\r\n\t\t\tif (!languages[code]) {\r\n\t\t\t\tcode = code.split('-')[0]; // fall back to base language\r\n\t\t\t}\r\n\t\t\tif (languages[code]) {\r\n\t\t\t\tcurrentLanguage = code;\r\n\t\t\t\treturn code; // so you can tell if fall-back has happened\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\taddLanguage: function (code, messageMap) {\r\n\t\t\tvar key;\r\n\t\t\tfor (key in ErrorCodes) {\r\n\t\t\t\tif (messageMap[key] && !messageMap[ErrorCodes[key]]) {\r\n\t\t\t\t\tmessageMap[ErrorCodes[key]] = messageMap[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar rootCode = code.split('-')[0];\r\n\t\t\tif (!languages[rootCode]) { // use for base language if not yet defined\r\n\t\t\t\tlanguages[code] = messageMap;\r\n\t\t\t\tlanguages[rootCode] = messageMap;\r\n\t\t\t} else {\r\n\t\t\t\tlanguages[code] = Object.create(languages[rootCode]);\r\n\t\t\t\tfor (key in messageMap) {\r\n\t\t\t\t\tif (typeof languages[rootCode][key] === 'undefined') {\r\n\t\t\t\t\t\tlanguages[rootCode][key] = messageMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlanguages[code][key] = messageMap[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\tfreshApi: function (language) {\r\n\t\t\tvar result = createApi();\r\n\t\t\tif (language) {\r\n\t\t\t\tresult.language(language);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tvalidate: function (data, schema, checkRecursive, banUnknownProperties) {\r\n\t\t\tvar def = defaultErrorReporter(currentLanguage);\r\n\t\t\tvar errorReporter = customErrorReporter ? function (error, data, schema) {\r\n\t\t\t\treturn customErrorReporter(error, data, schema) || def(error, data, schema);\r\n\t\t\t} : def;\r\n\t\t\tvar context = new ValidatorContext(globalContext, false, errorReporter, checkRecursive, banUnknownProperties);\r\n\t\t\tif (typeof schema === \"string\") {\r\n\t\t\t\tschema = {\"$ref\": schema};\r\n\t\t\t}\r\n\t\t\tcontext.addSchema(\"\", schema);\r\n\t\t\tvar error = context.validateAll(data, schema, null, null, \"\");\r\n\t\t\tif (!error && banUnknownProperties) {\r\n\t\t\t\terror = context.banUnknownProperties(data, schema);\r\n\t\t\t}\r\n\t\t\tthis.error = error;\r\n\t\t\tthis.missing = context.missing;\r\n\t\t\tthis.valid = (error === null);\r\n\t\t\treturn this.valid;\r\n\t\t},\r\n\t\tvalidateResult: function () {\r\n\t\t\tvar result = {toString: function () {\r\n\t\t\t\treturn this.valid ? 'valid' : this.error.message;\r\n\t\t\t}};\r\n\t\t\tthis.validate.apply(result, arguments);\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tvalidateMultiple: function (data, schema, checkRecursive, banUnknownProperties) {\r\n\t\t\tvar def = defaultErrorReporter(currentLanguage);\r\n\t\t\tvar errorReporter = customErrorReporter ? function (error, data, schema) {\r\n\t\t\t\treturn customErrorReporter(error, data, schema) || def(error, data, schema);\r\n\t\t\t} : def;\r\n\t\t\tvar context = new ValidatorContext(globalContext, true, errorReporter, checkRecursive, banUnknownProperties);\r\n\t\t\tif (typeof schema === \"string\") {\r\n\t\t\t\tschema = {\"$ref\": schema};\r\n\t\t\t}\r\n\t\t\tcontext.addSchema(\"\", schema);\r\n\t\t\tcontext.validateAll(data, schema, null, null, \"\");\r\n\t\t\tif (banUnknownProperties) {\r\n\t\t\t\tcontext.banUnknownProperties(data, schema);\r\n\t\t\t}\r\n\t\t\tvar result = {toString: function () {\r\n\t\t\t\treturn this.valid ? 'valid' : this.error.message;\r\n\t\t\t}};\r\n\t\t\tresult.errors = context.errors;\r\n\t\t\tresult.missing = context.missing;\r\n\t\t\tresult.valid = (result.errors.length === 0);\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\taddSchema: function () {\r\n\t\t\treturn globalContext.addSchema.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetSchema: function () {\r\n\t\t\treturn globalContext.getSchema.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetSchemaMap: function () {\r\n\t\t\treturn globalContext.getSchemaMap.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetSchemaUris: function () {\r\n\t\t\treturn globalContext.getSchemaUris.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetMissingUris: function () {\r\n\t\t\treturn globalContext.getMissingUris.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tdropSchemas: function () {\r\n\t\t\tglobalContext.dropSchemas.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tdefineKeyword: function () {\r\n\t\t\tglobalContext.defineKeyword.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tdefineError: function (codeName, codeNumber, defaultMessage) {\r\n\t\t\tif (typeof codeName !== 'string' || !/^[A-Z]+(_[A-Z]+)*$/.test(codeName)) {\r\n\t\t\t\tthrow new Error('Code name must be a string in UPPER_CASE_WITH_UNDERSCORES');\r\n\t\t\t}\r\n\t\t\tif (typeof codeNumber !== 'number' || codeNumber%1 !== 0 || codeNumber < 10000) {\r\n\t\t\t\tthrow new Error('Code number must be an integer > 10000');\r\n\t\t\t}\r\n\t\t\tif (typeof ErrorCodes[codeName] !== 'undefined') {\r\n\t\t\t\tthrow new Error('Error already defined: ' + codeName + ' as ' + ErrorCodes[codeName]);\r\n\t\t\t}\r\n\t\t\tif (typeof ErrorCodeLookup[codeNumber] !== 'undefined') {\r\n\t\t\t\tthrow new Error('Error code already used: ' + ErrorCodeLookup[codeNumber] + ' as ' + codeNumber);\r\n\t\t\t}\r\n\t\t\tErrorCodes[codeName] = codeNumber;\r\n\t\t\tErrorCodeLookup[codeNumber] = codeName;\r\n\t\t\tErrorMessagesDefault[codeName] = ErrorMessagesDefault[codeNumber] = defaultMessage;\r\n\t\t\tfor (var langCode in languages) {\r\n\t\t\t\tvar language = languages[langCode];\r\n\t\t\t\tif (language[codeName]) {\r\n\t\t\t\t\tlanguage[codeNumber] = language[codeNumber] || language[codeName];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\treset: function () {\r\n\t\t\tglobalContext.reset();\r\n\t\t\tthis.error = null;\r\n\t\t\tthis.missing = [];\r\n\t\t\tthis.valid = true;\r\n\t\t},\r\n\t\tmissing: [],\r\n\t\terror: null,\r\n\t\tvalid: true,\r\n\t\tnormSchema: normSchema,\r\n\t\tresolveUrl: resolveUrl,\r\n\t\tgetDocumentUri: getDocumentUri,\r\n\t\terrorCodes: ErrorCodes\r\n\t};\r\n\tapi.language(language || 'en');\r\n\treturn api;\r\n}\r\n\r\nvar tv4 = createApi();\r\ntv4.addLanguage('en-gb', ErrorMessagesDefault);\r\n\r\n//legacy property\r\ntv4.tv4 = tv4;\r\n\r\nreturn tv4; // used by _header.js to globalise.\r\n\r\n}));"],"sourceRoot":""}