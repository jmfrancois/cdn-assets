{"version":3,"sources":["webpack://Immutablediff/webpack/universalModuleDefinition","webpack://Immutablediff/webpack/bootstrap","webpack://Immutablediff/external \"Immutable\"","webpack://Immutablediff/./talend-umds/immutablediff/0.4.4/node_modules/immutablediff/src/diff.js","webpack://Immutablediff/./talend-umds/immutablediff/0.4.4/node_modules/immutablediff/src/utils.js","webpack://Immutablediff/./talend-umds/immutablediff/0.4.4/node_modules/immutablediff/src/lcs.js","webpack://Immutablediff/./talend-umds/immutablediff/0.4.4/node_modules/immutablediff/src/path.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Immutable","utils","lcs","path","concatPath","concat","escape","op","isMap","isIndexed","mapDiff","a","b","ops","is","areLists","lastKey","removeKey","forEach","aValue","aKey","has","sequenceDiff","bValue","push","bKey","count","lcsDiff","diff","pathIndex","val","newVal","mapDiffs","List","fromJS","primitiveTypeDiff","obj","Iterable","isKeyed","operation","DiffResult","Record","ReplaceResult","printDiff","matrix","xs","ys","xSize","ySize","diffArray","j","reverse","computeLcsMatrix","size","x","Array","makeMatrix","Math","max","backtrackLcs","slashRe","RegExp","escapedSlashRe","tildeRe","escapedTildeRe","Path","str","toString","replace","unescape"],"mappings":"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","file":"Immutablediff.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Immutablediff\"] = factory();\n\telse\n\t\troot[\"Immutablediff\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = Immutable;","'use strict';\n\nvar Immutable = require('immutable');\nvar utils = require('./utils');\nvar lcs = require('./lcs');\nvar path = require('./path');\nvar concatPath = path.concat,\n                  escape = path.escape,\n                  op = utils.op,\n                  isMap = utils.isMap,\n                  isIndexed = utils.isIndexed;\n\nvar mapDiff = function(a, b, p){\n  var ops = [];\n  var path = p || '';\n\n  if(Immutable.is(a, b) || (a == b == null)){ return ops; }\n\n  var areLists = isIndexed(a) && isIndexed(b);\n  var lastKey = null;\n  var removeKey = null\n\n  if(a.forEach){\n    a.forEach(function(aValue, aKey){\n      if(b.has(aKey)){\n        if(isMap(aValue) && isMap(b.get(aKey))){\n          ops = ops.concat(mapDiff(aValue, b.get(aKey), concatPath(path, escape(aKey))));\n        }\n        else if(isIndexed(b.get(aKey)) && isIndexed(aValue)){\n          ops = ops.concat(sequenceDiff(aValue, b.get(aKey), concatPath(path, escape(aKey))));\n        }\n        else {\n          var bValue = b.get ? b.get(aKey) : b;\n          var areDifferentValues = (aValue !== bValue);\n          if (areDifferentValues) {\n            ops.push(op('replace', concatPath(path, escape(aKey)), bValue));\n          }\n        }\n      }\n      else {\n        if(areLists){\n          removeKey = (lastKey != null && (lastKey+1) === aKey) ? removeKey : aKey;\n          ops.push( op('remove', concatPath(path, escape(removeKey))) );\n          lastKey = aKey;\n        }\n        else{\n          ops.push( op('remove', concatPath(path, escape(aKey))) );\n        }\n\n      }\n    });\n  }\n\n  b.forEach(function(bValue, bKey){\n    if(a.has && !a.has(bKey)){\n      ops.push( op('add', concatPath(path, escape(bKey)), bValue) );\n    }\n  });\n\n  return ops;\n};\n\nvar sequenceDiff = function (a, b, p) {\n  var ops = [];\n  var path = p || '';\n  if(Immutable.is(a, b) || (a == b == null)){ return ops; }\n  if((a.count() + 1) * (b.count() + 1) >= 10000 ) { return mapDiff(a, b, p); }\n\n  var lcsDiff = lcs.diff(a, b);\n\n  var pathIndex = 0;\n\n  lcsDiff.forEach(function (diff) {\n    if(diff.op === '='){ pathIndex++; }\n    else if(diff.op === '!='){\n      if(isMap(diff.val) && isMap(diff.newVal)){\n        var mapDiffs = mapDiff(diff.val, diff.newVal, concatPath(path, pathIndex));\n        ops = ops.concat(mapDiffs);\n      }\n      else{\n        ops.push(op('replace', concatPath(path, pathIndex), diff.newVal));\n      }\n      pathIndex++;\n    }\n    else if(diff.op === '+'){\n      ops.push(op('add', concatPath(path, pathIndex), diff.val));\n      pathIndex++;\n    }\n    else if(diff.op === '-'){ ops.push(op('remove', concatPath(path, pathIndex))); }\n  });\n\n  return ops;\n};\n\nvar primitiveTypeDiff = function (a, b, p) {\n  var path = p || '';\n  if(a === b){ return []; }\n  else{\n    return [ op('replace', concatPath(path, ''), b) ];\n  }\n};\n\nvar diff = function(a, b, p){\n  if(Immutable.is(a, b)){ return Immutable.List(); }\n  if(a != b && (a == null || b == null)){ return Immutable.fromJS([op('replace', '/', b)]); }\n  if(isIndexed(a) && isIndexed(b)){\n    return Immutable.fromJS(sequenceDiff(a, b));\n  }\n  else if(isMap(a) && isMap(b)){\n    return Immutable.fromJS(mapDiff(a, b));\n  }\n  else{\n    return Immutable.fromJS(primitiveTypeDiff(a, b, p));\n  }\n};\n\nmodule.exports = diff;\n","'use strict';\n\nvar Immutable = require('immutable');\n\nvar isMap = function(obj){ return Immutable.Iterable.isKeyed(obj); };\nvar isIndexed = function(obj) { return Immutable.Iterable.isIndexed(obj); };\n\nvar op = function(operation, path, value){\n  if(operation === 'remove') { return { op: operation, path: path }; }\n\n  return { op: operation, path: path, value: value };\n};\n\nmodule.exports = {\n  isMap: isMap,\n  isIndexed: isIndexed,\n  op: op\n};","'use strict';\n\nvar Immutable = require('immutable');\n\n/**\n * Returns a two-dimensional array (an array of arrays) with dimensions n by m.\n * All the elements of this new matrix are initially equal to x\n * @param n number of rows\n * @param m number of columns\n * @param x initial element for every item in matrix\n */\nvar makeMatrix = function(n, m, x){\n  var matrix = [];\n  for(var i = 0; i < n; i++) {\n    matrix[i] = new Array(m);\n\n    if(x != null){\n      for(var j = 0; j < m; j++){\n        matrix[i][j] = x;\n      }\n    }\n  }\n\n  return matrix;\n};\n\n/**\n * Computes Longest Common Subsequence between two Immutable.JS Indexed Iterables\n * Based on Dynamic Programming http://rosettacode.org/wiki/Longest_common_subsequence#Java\n * @param xs ImmutableJS Indexed Sequence 1\n * @param ys ImmutableJS Indexed Sequence 2\n */\nvar lcs = function(xs, ys){\n  var matrix = computeLcsMatrix(xs, ys);\n\n  return backtrackLcs(xs, ys, matrix);\n};\n\nvar DiffResult = Immutable.Record({op: '=', val: null});\nvar ReplaceResult = Immutable.Record({op: '!=', val: null, newVal: null});\n\n/**\n * Returns the resulting diff operations of LCS between two sequences\n * @param xs Indexed Sequence 1\n * @param ys Indexed Sequence 2\n * @returns Array of DiffResult {op:'=' | '+' | '-', val:any}\n */\nvar diff = function(xs, ys){\n  var matrix = computeLcsMatrix(xs, ys);\n\n  return printDiff(matrix, xs, ys, xs.size||0, ys.size||0);\n};\n\nvar printDiff = function(matrix, xs, ys, xSize, ySize) {\n  var diffArray = [];\n  var i = xSize - 1;\n  var j = ySize - 1;\n  while (i >= 0 || j >= 0) {\n    if (i >= 0 && j >= 0 && Immutable.is(xs.get(i), ys.get(j))) {\n      diffArray.push(new DiffResult({\n        op: '=',\n        val: xs.get(i)\n      }));\n      i -= 1;\n      j -= 1;\n    }\n    else if (i >= 0 && j >= 0 && i === j && !Immutable.is(xs.get(i), ys.get(j))) {\n      diffArray.push(new ReplaceResult({\n      val: xs.get(i),\n      newVal: ys.get(i)\n      }));\n      i -= 1;\n      j -= 1;\n    }\n    else {\n      if (j >= 0 && (i === -1 || matrix[i+1][j] >= matrix[i][j+1])) {\n        diffArray.push(new DiffResult({\n          op: '+',\n          val: ys.get(j)\n        }));\n        j -= 1;\n      }\n      else if (i >= 0 && (j === -1 || matrix[i+1][j] < matrix[i][j+1])){\n        diffArray.push(new DiffResult({\n          op: '-',\n          val: xs.get(i)\n        }));\n        i -= 1;\n      }\n    }\n  }\n  return diffArray.reverse();\n};\n\n/**\n * Computes the Longest Common Subsequence table\n * @param xs Indexed Sequence 1\n * @param ys Indexed Sequence 2\n */\nfunction computeLcsMatrix(xs, ys) {\n  var n = xs.size||0;\n  var m = ys.size||0;\n  var a = makeMatrix(n + 1, m + 1, 0);\n\n  for (var i = 0; i < n; i++) {\n    for (var j = 0; j < m; j++) {\n      if (Immutable.is(xs.get(i), ys.get(j))) {\n        a[i + 1][j + 1] = a[i][j] + 1;\n      }\n      else {\n        a[i + 1][j + 1] = Math.max(a[i + 1][j], a[i][j + 1]);\n      }\n    }\n  }\n\n  return a;\n}\n\n/**\n * Extracts a LCS from matrix M\n * @param xs Indexed Sequence 1\n * @param ys Indexed Sequence 2\n * @param matrix LCS Matrix\n * @returns {Array.<T>} Longest Common Subsequence\n */\nvar backtrackLcs = function(xs, ys, matrix){\n  var lcs = [];\n  for(var i = xs.size, j = ys.size; i !== 0 && j !== 0;){\n    if (matrix[i][j] === matrix[i-1][j]){ i--; }\n    else if (matrix[i][j] === matrix[i][j-1]){ j--; }\n    else{\n      if(Immutable.is(xs.get(i-1), ys.get(j-1))){\n        lcs.push(xs.get(i-1));\n        i--;\n        j--;\n      }\n    }\n  }\n  return lcs.reverse();\n};\n\nmodule.exports = {\n  lcs: lcs,\n  computeLcsMatrix: computeLcsMatrix,\n  diff: diff\n};\n","'use strict';\n\nvar slashRe = new RegExp('/', 'g');\nvar escapedSlashRe = new RegExp('~1', 'g');\nvar tildeRe = /~/g;\nvar escapedTildeRe = /~0/g;\n\nvar Path = {\n  escape: function (str) {\n    if(typeof(str) === 'number'){\n      return str.toString();\n    }\n    if(typeof(str) !== 'string'){\n      throw 'param str (' + str + ') is not a string';\n    }\n\n    return str.replace(tildeRe, '~0').replace(slashRe, '~1');\n  },\n\n  unescape: function (str) {\n    if(typeof(str) == 'string') {\n      return str.replace(escapedSlashRe, '/').replace(escapedTildeRe, '~');\n    }\n    else {\n      return str;\n    }\n  },\n  concat: function(path, key){\n    return path + '/' + key;\n  }\n};\n\nmodule.exports = Path;"],"sourceRoot":""}